Function GetValueFromDictionnaire(dico As Object, NumId As Variant, ISIN As Variant, label As String) As Variant
    Dim dicoISIN As Object
    Dim tableauCaracteristiques As Variant
    Dim i As Long
    Dim labelTrouve As Boolean
    Dim indexColonne As Long
    
    ' Vérifier si NumId existe dans le dictionnaire
    If Not dico.Exists(NumId) Then
        GetValueFromDictionnaire = "NumId non trouvé"
        Exit Function
    End If

    ' Obtenir le dictionnaire pour ce NumId
    Set dicoISIN = dico(NumId)
    
    ' Vérifier si ISIN existe dans le dictionnaire
    If Not dicoISIN.Exists(ISIN) Then
        GetValueFromDictionnaire = "ISIN non trouvé"
        Exit Function
    End If

    ' Obtenir le tableau de caractéristiques
    tableauCaracteristiques = dicoISIN(ISIN)
    
    ' Trouver l'index de la colonne correspondant au label
    labelTrouve = False
    For i = LBound(tableauCaracteristiques, 2) To UBound(tableauCaracteristiques, 2)
        If tableauCaracteristiques(1, i) = label Then
            indexColonne = i
            labelTrouve = True
            Exit For
        End If
    Next i
    
    ' Retourner la valeur si le label a été trouvé
    If labelTrouve Then
        GetValueFromDictionnaire = tableauCaracteristiques(2, indexColonne) ' 2 pour la ligne de valeurs
    Else
        GetValueFromDictionnaire = "Label non trouvé"
    End If
End Function

