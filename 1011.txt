

Sub ModifierArrayAvecDictionnaire(ByRef ArrRef As Variant, ArrToCompare As Variant, BoolAdd As Boolean)
    Dim dictRef As Object
    Dim dictCompare As Object
    Dim i As Long
    Dim valeur As Variant
    Dim n As Long
    
    ' Créer les dictionnaires
    Set dictRef = CreateObject("Scripting.Dictionary")
    Set dictCompare = CreateObject("Scripting.Dictionary")
    
    ' Remplir dictRef avec les valeurs de ArrRef
    For i = 1 To UBound(ArrRef)
        dictRef(ArrRef(i, 1)) = True ' Utilisation de "True" comme valeur d'indicateur
    Next i

    ' Remplir dictCompare avec les valeurs de ArrToCompare
    For i = 1 To UBound(ArrToCompare)
        dictCompare(ArrToCompare(i, 1)) = True
    Next i

    ' Vérifier les éléments dans ArrToCompare et agir en fonction de BoolAdd
    For i = 1 To UBound(ArrToCompare)
        valeur = ArrToCompare(i, 1)
        
        If BoolAdd Then
            ' Ajouter à ArrRef si pas présent dans dictRef
            If Not dictRef.exists(valeur) Then
                dictRef(valeur) = True
            End If
        Else
            ' Retirer de ArrRef si présent dans dictRef
            If dictRef.exists(valeur) Then
                dictRef.Remove valeur
            End If
        End If
    Next i

    ' Calculer la taille de ArrRef après modification
    n = dictRef.Count

    ' Re-dimensionner ArrRef pour correspondre à la nouvelle taille
    Erase ArrRef
    ReDim ArrRef(1 To n, 1 To 1)

    ' Reconvertir les valeurs du dictionnaire dans ArrRef
    i = 1
    For Each valeur In dictRef.Keys
        ArrRef(i, 1) = valeur
        i = i + 1
    Next valeur
End Sub


'''One valeur



Sub ModifierArrayAvecDictionnaire(ByRef ArrRef As Variant, valeur As Variant, BoolAdd As Boolean)
    Dim dictRef As Object
    Dim n As Long
    Dim i As Long
    
    ' Créer le dictionnaire
    Set dictRef = CreateObject("Scripting.Dictionary")
    
    ' Remplir dictRef avec les valeurs de ArrRef
    For i = 1 To UBound(ArrRef)
        dictRef(ArrRef(i, 1)) = True ' Utilisation de "True" comme valeur d'indicateur
    Next i

    ' Vérifier la valeur et agir en fonction de BoolAdd
    If BoolAdd Then
        ' Ajouter la valeur à ArrRef si elle n'existe pas déjà
        If Not dictRef.exists(valeur) Then
            dictRef(valeur) = True
        End If
    Else
        ' Retirer la valeur de ArrRef si elle existe déjà
        If dictRef.exists(valeur) Then
            dictRef.Remove valeur
        End If
    End If

    ' Calculer la taille de ArrRef après modification
    n = dictRef.Count

    ' Re-dimensionner ArrRef pour correspondre à la nouvelle taille
    Erase ArrRef
    ReDim ArrRef(1 To n, 1 To 1)

    ' Reconvertir les valeurs du dictionnaire dans ArrRef
    i = 1
    For Each valeur In dictRef.Keys
        ArrRef(i, 1) = valeur
        i = i + 1
    Next valeur
End Sub


Private Sub CommandButton1_Click()

    ' Vérifier si un élément est sélectionné dans ListBox1 et ListBox2
    If ListBox1.ListIndex = -1 Then
        MsgBox "Veuillez sélectionner un élément dans ListBox1.", vbExclamation
        Exit Sub
    End If
    
    If ListBox2.ListIndex = -1 Then
        MsgBox "Veuillez sélectionner un élément dans ListBox2.", vbExclamation
        Exit Sub
    End If
    
    ' Remplacer l'élément sélectionné de ListBox2 par l'élément sélectionné de ListBox1
    ListBox2.List(ListBox2.ListIndex) = ListBox1.List(ListBox1.ListIndex)

End Sub

Private Sub Listbox1_Dblclick(ByVal Cancel As MSForms.ReturnBoolean)
    If Cible = False Then
            Cible = True
            Valeur = ListBox1
            ListBox1.RemoveItem ListBox1.ListIndex
        Else
            Cible = False
            ListBox1.AddItem Valeur, ListBox1.ListIndex + 1
    End If
End Sub

